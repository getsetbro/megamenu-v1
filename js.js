var myData = [
  {
    Title: "Report Library",
    URL:
      "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/ReportLibrary.aspx",
    ChildLinks: [
      {
        Title: "Overall",
        URL: null,
        ChildLinks: [
          {
            Title: "Balanced Scorecard",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=480&ReportGroup=Balanced+Scorecard",
            ChildLinks: null
          },
          {
            Title: "Close for SHOPX",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=515&ReportGroup=Close+for+Safety,+Health+Outcomes,+Patient+Experience",
            ChildLinks: null
          },
          {
            Title: "Executive Dashboards",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=354&ReportGroup=Executive+Dashboards",
            ChildLinks: null
          }
        ]
      },
      {
        Title: "Safety & Quality",
        URL: null,
        ChildLinks: [
          {
            Title: "ADI",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=216&ReportGroup=ADI+-+Advocate+Data+Intelligence",
            ChildLinks: null
          },
          {
            Title: "Be Safe Tools Audit",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=321&ReportGroup=Be+Safe+Tools+Audit",
            ChildLinks: null
          },
          {
            Title: "Clinical Integration",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=432&ReportGroup=Clinical+Integration",
            ChildLinks: null
          },
          {
            Title: "Complications",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=13&ReportGroup=Complications",
            ChildLinks: null
          },
          {
            Title: "Core Measures",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=511&ReportGroup=Core+Measures",
            ChildLinks: null
          },
          {
            Title: "CPOE",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=31&ReportGroup=CPOE",
            ChildLinks: null
          },
          {
            Title: "Culture of Safety",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=505&ReportGroup=Culture+of+Safety+Survey",
            ChildLinks: null
          },
          {
            Title: "Falls",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=392&ReportGroup=Falls",
            ChildLinks: null
          },
          {
            Title: "HAC Composite",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=53&ReportGroup=HAC+Composite",
            ChildLinks: null
          },
          {
            Title: "ICU Ventilator Days",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=424&ReportGroup=ICU+Ventilator+Days",
            ChildLinks: null
          },
          {
            Title: "IHA Health Outcomes",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=67&ReportGroup=IHA+Health+Outcomes",
            ChildLinks: null
          },
          {
            Title: "Infection Prevention",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=454&ReportGroup=Infection+Prevention",
            ChildLinks: null
          },
          {
            Title: "Lab Panels",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=431&ReportGroup=Lab+Panels",
            ChildLinks: null
          },
          {
            Title: "Length of Stay",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=258&ReportGroup=Length+of+Stay",
            ChildLinks: null
          },
          {
            Title: "Mortality",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=105&ReportGroup=Mortality",
            ChildLinks: null
          },
          {
            Title: "Obstetrics",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=317&ReportGroup=Obstetrics",
            ChildLinks: null
          },
          {
            Title: "Readmissions",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=539&ReportGroup=Readmissions",
            ChildLinks: null
          },
          {
            Title: "Readmissions - ACH",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=107&ReportGroup=Readmissions+-+Pediatric",
            ChildLinks: null
          },
          {
            Title: "Restraints",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=359&ReportGroup=Restraints",
            ChildLinks: null
          },
          {
            Title: "RRT",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=137&ReportGroup=RRT",
            ChildLinks: null
          },
          {
            Title: "Safety Reporting",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=468&ReportGroup=Safety+Reporting",
            ChildLinks: null
          },
          {
            Title: "Sepsis",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=325&ReportGroup=Sepsis",
            ChildLinks: null
          },
          {
            Title: "Transfusions - System",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=143&ReportGroup=Transfusion+Safety+-+System",
            ChildLinks: null
          }
        ]
      },
      {
        Title: "Patient Experience",
        URL: null,
        ChildLinks: [
          {
            Title: "Benchmarks",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=166&ReportGroup=Patient+Experience+-+Benchmarks+for+CAHPS+and+PG+Surveys",
            ChildLinks: null
          },
          {
            Title: "Patient Detail",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=225&ReportGroup=Patient+Experience+-+Patient+Detail",
            ChildLinks: null
          },
          {
            Title: "Pediatric Satisfaction",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=373&ReportGroup=Patient+Experience+-+Pediatric+Satisfaction",
            ChildLinks: null
          },
          {
            Title: "Satisfaction",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=288&ReportGroup=Patient+Experience+-+Satisfaction",
            ChildLinks: null
          },
          {
            Title: "Service Reliability (CAHPS)",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=167&ReportGroup=Patient+Experience+-+Service+Reliability+(CAHPS)",
            ChildLinks: null
          }
        ]
      },
      {
        Title: "Coordinated Care",
        URL: null,
        ChildLinks: [
          {
            Title: "CMS Important Message",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=11&ReportGroup=CMS+Important+Message",
            ChildLinks: null
          },
          {
            Title: "Home Health Capture",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=56&ReportGroup=Home+Health+Capture+Rate",
            ChildLinks: null
          },
          {
            Title: "IPOC",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=238&ReportGroup=IPOC",
            ChildLinks: null
          },
          {
            Title: "Transition Prgm - Hospitals",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=165&ReportGroup=Transition+Program+-+Hospitals",
            ChildLinks: null
          }
        ]
      },
      {
        Title: "Enterprise Population Health",
        URL: null,
        ChildLinks: [
          {
            Title: "ACI",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=395&ReportGroup=APP+Accountable+Care+Index+Drill-Down",
            ChildLinks: null
          },
          {
            Title: "EPH CUI",
            URL:
              "http://sptestreports.advocatehealth.com/sites/chis/SYSTEM/Pages/reportviewer.aspx?ReportID=514&ReportGroup=Enterprise+Population+Health+Cost+and+Utilization+Index+Drill-Down",
            ChildLinks: null
          }
        ]
      }
    ]
  }
];

function do_megamenu(global, document, myMegamenu) {
  var el_mm_cats = document.getElementsByClassName("megamenu-categories")[0];
  var el_mm_items = document.getElementsByClassName("megamenu-items")[0];
  var megamenu_entries = Object.entries(myMegamenu);
  var category_timeout;
  var megamenu_timeout_in;
  var megamenu_timeout_out;
  var div_cols = {};
  var swap_name;
  var first_one = true;

  var new_div_cat = function(name) {
    var el_d = document.createElement("DIV"); // Create a <div> element
    el_d.addEventListener("mouseover", mm_mouseIn, false);
    el_d.addEventListener("mouseout", mm_mouseExit, false);
    el_d.className = "megamenu-category";
    if (first_one) {
      el_d.setAttribute("name", "first");
      first_one = false;
    }
    el_d.innerText = name; // Insert text
    return el_d;
  };

  var new_a_link = function(o) {
    var el_a = document.createElement("A"); // Create a <a> element
    el_a.className = "megamenu-items-a";
    el_a.setAttribute("href", o.URL);
    el_a.innerText = o.Title; // Insert text
    return el_a;
  };

  megamenu_entries.forEach(function(kvp) {
    var name = kvp[0];
    var links = kvp[1];

    div_cols[name] = {};
    div_cols[name].div_col = document.createElement("DIV"); // Create a <div> element
    div_cols[name].div_col.className = "megamenu-columns";

    el_mm_cats.appendChild(new_div_cat(name));

    links.forEach(function(link) {
      //add links
      div_cols[name].div_col.appendChild(new_a_link(link));
    });
  });

  var el_first_cat = document.querySelectorAll(
    ".megamenu-category[name='first']"
  )[0];
  var event_trigger = document.createEvent("HTMLEvents");
  event_trigger.initEvent("mouseover", true, false);
  el_first_cat.dispatchEvent(event_trigger);

  function mm_mouseIn(e) {
    if (swap_name === e.target.innerText) {
      return;
    }
    clearTimeout(category_timeout);
    swap_name = e.target.innerText;
    category_timeout = setTimeout(function() {
      var elems = document.querySelectorAll(
        ".megamenu-category[name='active']"
      );
      [].forEach.call(elems, function(el) {
        el.removeAttribute("name");
      });
      e.target.setAttribute("name", "active");

      el_mm_items.replaceChild(
        div_cols[swap_name].div_col,
        el_mm_items.firstElementChild
      );
    }, 444);
  }

  function mm_mouseExit(e) {
    // if (swap_name === e.target.innerText) {return;}
    clearTimeout(category_timeout);
  }

  var ni_replib = document.querySelectorAll(".report-library")[0];
  ni_replib.addEventListener("mouseenter", function(e) {
    clearTimeout(megamenu_timeout_out);
    megamenu_timeout_in = setTimeout(function() {
      //ni_replib.classList.add("active");
      ni_replib.setAttribute("name", "active");
    }, 444);
  });

  ni_replib.addEventListener("mouseleave", function(e) {
    clearTimeout(megamenu_timeout_in);
    megamenu_timeout_out = setTimeout(function() {
      //ni_replib.classList.remove("active");
      ni_replib.removeAttribute("name");
    }, 555);
  });
}

if (myData) {
  if (!Object.entries) {
    Object.entries = function(obj) {
      var ownProps = Object.keys(obj),
        i = ownProps.length,
        resArray = new Array(i); // preallocate the Array
      while (i--) resArray[i] = [ownProps[i], obj[ownProps[i]]];

      return resArray;
    };
  }
  var myMegamenu = {};
  myData[0].ChildLinks.forEach(function(cat) {
    myMegamenu[cat.Title] = [];
    cat.ChildLinks.forEach(function(link) {
      myMegamenu[cat.Title].push({ Title: link.Title, URL: link.URL });
    });
  });
  do_megamenu(window, document, myMegamenu);
}
